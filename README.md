# Code for "Phase transitions in in vivo or in vitro populations of spiking neurons belong to different universality classes," Brinkman PRX Life 2025
This repository contains code to generate the simulated data analyzed in doi:10.1103/kjx5-1hwy

Simulation code
-

Matlab code for simulating the network model. For the in vitro (absorbing state) network models all data is generated by running

StochasticNetwork_Ntrials_absorbing_nonlinsweep.m

To generate the data for a desired network, uncomment the relevant block of code at the beginning of the script.

For the in vivo (spontaneous) networks, there is a separate file for each network type to sweep over a grid in the Eleak and J space. The networks for the spontaneous case are 2d lattice (periodic boundary conditions), 3d lattice (periodic boundary conditions), excitatory random regular networks with degree 3, random regular networks with degree 3 and global inhibition, explicit excitatory-inhibitory networks.

StochasticNetwork_lattice_d2.m
StochasticNetwork_lattice_d3.m
StochasticNetwork_randreg_deg3.m
StochasticNetwork_randregwithInhib_deg3.m
StochasticNetwork_randregEIexplicit_deg3.m

These scripts load in adjacency matrices from

adj_lattice_d2_L53.txt
adj_lattice_d3_L14.txt
adj_configmodel_deg3and4_3frac0.8_N2000_seed8.txt
adj_configmodel_deg3and4_3frac0.9_N2000_seed12.txt



Note that the simulations involving random regular graphs use a function https://www.mathworks.com/matlabcentral/fileexchange/29786-random-regular-generator


Mathematica notebooks
-

There are four notebooks in this folder, 2 for each of the in vivo (absorbing) and in vitro  (spontaneous) cases.
Phihierarchy_3dlattice_absorbing.nb
Phihierarchy_3dlattice_spontaneous.nb
Phihierarchy_randomregular_absorbing.nb
Phihierarchy_randomregular_spontaneous.nb

Figure plotting code
-

The scripts in this folder reproduce the figures in the paper. The necessary data is also contained in this folder. The scripts and data files associated with each figure are listed below. Some scripts refer to the function export_fig available at https://www.mathworks.com/matlabcentral/fileexchange/23629-export_fig

Fig. 1

introschemrasters.m
RandomRegularGraphEIExplicit_absorbing_forintroschematic_deg3_Ntrials1_NE2048_NI512_Tmax5000_J1.16_.txt
RandomRegularGraphEIExplicit_absorbing_forintroschematic_deg3_Ntrials1_NE2048_NI512_Tmax5000_J2.32_.txt
RandomRegularGraphEIExplicit_absorbing_forintroschematic_deg3_Ntrials1_NE2048_NI512_Tmax5000_J4.64_.txt
RandomRegularGraphEIExplicit_spontaneous_forintroschematic_deg3_Ntrials1_NE2048_NI512_Tmax20000_icFactor10_J3_Eleak-3.2175.txt
RandomRegularGraphEIExplicit_spontaneous_forintroschematic_deg3_Ntrials1_NE2048_NI512_Tmax20000_icFactor10_J6_Eleak-5.1975.txt
RandomRegularGraphEIExplicit_spontaneous_forintroschematic_deg3_Ntrials1_NE2048_NI512_Tmax20000_icFactor10_J12_Eleak-9.1575.txt


Fig. 2

NPRG_meanfieldcollapse_figplotter.m


Fig. 3

NPRG_latticecollapse_figplotter.m

Lattice_absorbing_nonlinsweep_d2_Ntrials100_N2809_Tmax5000_J<x>.txt
where x = 1.0, 1.1, 1.2, 1.3, 1.4, 1.5, 1.52, 1.54, 1.56, 1.58, 1.6, 1.7, 1.8, 1.9

Lattice_absorbing_nonlinsweep_d3_Ntrials100_N2744_Tmax5000_J<x>.txt
where x = 0.75, 0.8, 0.81, 0.82, 0.83, 0.84, 0.85

Files in the folders 
Lattice_trackingEwithnprg_d2_Ntrials10_N2809_Tmax1000_icFactor10
Lattice_trackingEwithnprg_d2_Ntrials10_N2809_Tmax1000_icFactor-10
Lattice_trackingEwithnprg_d3_Ntrials10_N2744_Tmax1000_icFactor10
Lattice_trackingEwithnprg_d3_Ntrials10_N2744_Tmax1000_icFactor-10

Fig. 4

NPRG_randregcollapse_figplotter.m

RandomRegularGraph_absorbing_nonlinsweep_deg3_Ntrials100_N2048_Tmax10000_J<x>.txt
RandomRegularGraphwithInhib_absorbing_nonlinsweep_deg3_Ntrials100_N2048_Tmax10000_J<x>.txt
where x = 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5

RandomRegularGraphEIExplicit_absorbing_nonlinsweep_deg3_Ntrials100_NE2048_NI512_Tmax100000_J<x>_excitatory.txt
where x = 2.0, 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7

Files in the folders
RandomRegularGraph_trackingEwithnprg_deg3_Ntrials10_N2048_Tmax1000_icFactor10
RandomRegularGraph_trackingEwithnprg_deg3_Ntrials10_N2048_Tmax1000_icFactor-10
RandomRegularGraphwithInhib_deg3_Ntrials10_N2048_Tmax1000_icFactor10
RandomRegularGraphwithInhib_deg3_Ntrials10_N2048_Tmax1000_icFactor-10
RandomRegularGraphEIExplicit_spontaneous_deg3_Ntrials10_NE2048_NI512_Tmax5000_icFactor10

NPRGPhi_mf_Fbarscalingfunction.txt

Fig. 5

NPRG_randconfig_plotter_nononlins.m

RandomRegularGraphwithInhib_absorbing_nonlinsweep_deg4_Ntrials10_N2048_Tmax10000_J<x>.txt
where x = {0.6,0.7,0.8,0.9,1.0,1.1}*4/(2*sqrt(3)-1)

RandConfigwithInhib_deg3and4_absorbing_nonlinsweep_Ntrials100_N2000_Tmax10000_J<x>_frac<y>.txt
where x = 1.9, 2.0, 2.1, 2.2, 2.3, 2.4, 2.5 
and y = 0.8, 0.9

Fig. 6

Generate data using
selfconsistent_lattice3d_absorbing.m
selfconsistent_lattice3d_spontaneous.m 

Also load
Lattice_nonlinsweep_d3_Ntrials100_N3375_Tmax1000_J1.18_Eleak-1.7246
Lattice_nonlinsweep_d3_Ntrials100_N3375_Tmax1000_J1.5_Eleak-3.625.txt
Lattice_nonlinsweep_d3_Ntrials100_N3375_Tmax1000_J2_Eleak-4.875.txt


Plot the data using
selfcon_nonlinplotter.m

Fig. 7
coarsegrainedJplotter.m

adj_lattice_d3_L4.txt
Latticedensity_d3_J1.txt


Fig. 8
NPRG_nonlinsforpaper.m

NPRGPhi_lattice_d3_absorbingsigmoid_J0p4125_O4.txt
NPRGPhi_lattice_d3_absorbingsigmoid_J0p825_O4.txt
NPRGPhi_lattice_d3_absorbingsigmoid_J1p65_O4.txt
NPRGPhi_lattice_d3_sigmoid_J0p5825_O4.txt
NPRGPhi_lattice_d3_sigmoid_J1p165_O4.txt
NPRGPhi_lattice_d3_sigmoid_J2p33_O4.txt
NPRGPhi_randreg_deg3_absorbingsigmoid_J1p085_O4.txt
NPRGPhi_randreg_deg3_absorbingsigmoid_J2p17_O4.txt
NPRGPhi_randreg_deg3_absorbingsigmoid_J4p34_O4.txt
NPRGPhi_randreg_deg3_spontsigmoid_J1p875_O4.txt
NPRGPhi_randreg_deg3_spontsigmoid_J3p75_O4.txt
NPRGPhi_randreg_deg3_spontsigmoid_J7p5_O4.txt
NPRGPhi_randreg_deg3_absorbingsigmoid_J1p16_O4.txt
NPRGPhi_randreg_deg3_absorbingsigmoid_J2p32_O4.txt
NPRGPhi_randreg_deg3_absorbingsigmoid_J4p64_O4.txt
NPRGPhi_randreg_deg3_spontsigmoid_J3p0_O4.txt
NPRGPhi_randreg_deg3_spontsigmoid_J6p0_O4.txt
NPRGPhi_randreg_deg3_spontsigmoid_J12p0_O4.txt

Lattice_absorbing_nonlinsweep_d3_Ntrials100_N2744_Tmax1000_J0.4125.txt
Lattice_absorbing_nonlinsweep_d3_Ntrials100_N2744_Tmax1000_J0.825.txt
Lattice_absorbing_nonlinsweep_d3_Ntrials100_N2744_Tmax10000_J1.65.txt

Lattice_nonlinsweep_d3_Ntrials100_N3375_Tmax1000_J0.5825_Eleak-1.3313.txt
Lattice_nonlinsweep_d3_Ntrials100_N3375_Tmax1000_J1.165_Eleak-2.7875.txt
Lattice_nonlinsweep_d3_Ntrials100_N3375_Tmax1000_J2.33_Eleak-5.7.txt

RandomRegularGraph_absorbing_nonlinsweep_deg3_Ntrials100_N2048_Tmax1000_J1.085.txt
RandomRegularGraph_absorbing_nonlinsweep_deg3_Ntrials100_N2048_Tmax1000_J2.17.txt
RandomRegularGraph_absorbing_nonlinsweep_deg3_Ntrials100_N2048_Tmax1000_J4.34.txt

RandomRegularGraph_spontaneous_nonlinsweep_deg3_Ntrials100_N2048_Tmax1000_J1.875.txt
RandomRegularGraph_spontaneous_nonlinsweep_deg3_Ntrials100_N2048_Tmax1000_J3.75.txt
RandomRegularGraph_spontaneous_nonlinsweep_deg3_Ntrials100_N2048_Tmax1000_J7.5.txt

RandomRegularGraphwithInhib_absorbing_nonlinsweep_deg3_Ntrials100_N2048_Tmax1000_J1.16.txt
RandomRegularGraphwithInhib_absorbing_nonlinsweep_deg3_Ntrials100_N2048_Tmax1000_J2.32.txt
RandomRegularGraphwithInhib_absorbing_nonlinsweep_deg3_Ntrials100_N2048_Tmax1000_J4.64.txt

RandomRegularGraphwithInhib_spontaneous_nonlinsweep_deg3_Ntrials100_N2048_Tmax1000_J3.txt
RandomRegularGraphwithInhib_spontaneous_nonlinsweep_deg3_Ntrials100_N2048_Tmax1000_J6.txt
RandomRegularGraphwithInhib_spontaneous_nonlinsweep_deg3_Ntrials100_N2048_Tmax1000_J12.txt


Fig. 9
NPRG_DPresults_figureplotter.m

dpfixedpointforward.m

NPRG_DirectedPercolation_truncation_nueps.txt
NPRG_DirectedPercolation_truncation_nuO3.txt
NPRG_DirectedPercolation_truncation_nuO4.txt
NPRG_DirectedPercolation_truncation_nuO5.txt

NPRGvarphi_DP_fixedpoints_criticalpotential_d3_O5.txt
NPRGvarphi_DP_fixedpoints_relevantmode_d3_O5.txt
NPRGvarphi_DP_fixedpoints_irrelevantmode1_d3_O5.txt
NPRGvarphi_DP_fixedpoints_irrelevantmode2_d3_O5.txt

Fig. 10
NPRG_isingmodelresults_figureplotter.m

WFfixedpoint.m

NPRGvarphi_WF_fixedpoints_linRG_Om1n25_nu.txt
NPRGvarphi_WF_fixedpoints_linRG_Om1n11_nu.txt
NPRGvarphi_WF_fixedpoints_linRG_Om1n9_nu.txt
NPRGvarphi_WF_fixedpoints_linRG_Om1n7_nu.txt
NPRGvarphi_WF_fixedpoints_linRG_Om1n5_nu.txt

NPRGvarphi_WF_fixedpoints_criticalnonlin_Om1n11.txt
NPRGvarphi_WF_fixedpoints_relevantmode_Om1n11.txt
NPRGvarphi_WF_fixedpoints_irrelevantmode1_Om1n11.txt
NPRGvarphi_WF_fixedpoints_irrelevantmode2_Om1n11.txt
